Invoke-WebRequest "https://tazeacorestorage.blob.core.windows.net/sysprep-tools/wallpaper.png?sp=r&st=2022-11-21T22:00:59Z&se=2022-11-22T06:00:59Z&spr=https&sv=2021-06-08&sr=b&sig=%2BatPC7XdUubrmKrPAYUsiGiFiOKhohApJhda3K9%2Fgdw%3D" -OutFile C:\wallpaper.png

Function Set-WallPaper($Image) {
  
Add-Type -TypeDefinition @" 
using System; 
using System.Runtime.InteropServices;
  
public class Params
{ 
    [DllImport("User32.dll",CharSet=CharSet.Unicode)] 
    public static extern int SystemParametersInfo (Int32 uAction, 
                                                   Int32 uParam, 
                                                   String lpvParam, 
                                                   Int32 fuWinIni);
}
"@ 
  
    $SPI_SETDESKWALLPAPER = 0x0014
    $UpdateIniFile = 0x01
    $SendChangeEvent = 0x02
  
    $fWinIni = $UpdateIniFile -bor $SendChangeEvent
  
    $ret = [Params]::SystemParametersInfo($SPI_SETDESKWALLPAPER, 0, $Image, $fWinIni)
 
}

Set-WallPaper -Image "C:\wallpaper.png"
# SIG # Begin signature block
# MIIL1QYJKoZIhvcNAQcCoIILxjCCC8ICAQExCzAJBgUrDgMCGgUAMGkGCisGAQQB
# gjcCAQSgWzBZMDQGCisGAQQBgjcCAR4wJgIDAQAABBAfzDtgWUsITrck0sYpfvNR
# AgEAAgEAAgEAAgEAAgEAMCEwCQYFKw4DAhoFAAQUysyuw7QuTLHlCg6KmusLRCPN
# CragggllMIIDzDCCArSgAwIBAgIBCTANBgkqhkiG9w0BAQsFADBEMQswCQYDVQQG
# EwJVUzEMMAoGA1UECgwDU0RDMREwDwYDVQQLDAhTREMgQXV0aDEUMBIGA1UEAwwL
# U0RDIFJvb3QgQ0EwHhcNMjEwODA1MjEzMzA2WhcNMzEwODA1MjEzMzA2WjAiMSAw
# HgYDVQQDExdzbWlsZWNvLU9XSFFWU1VCQ0EwMS1DQTCCASIwDQYJKoZIhvcNAQEB
# BQADggEPADCCAQoCggEBAOnyHy7W7F6Jj2Kli2Gd4x12Jg+YAFGuC47/dIZX/2EP
# j4ujgr/s/HAPfSNVA+9oTtzUo0uy3CWEmMFs91DqyI3EwYwUi2ZD4KplHTEJ5pI4
# VU0jdsKgWcZlHJLvlUacDtvZ6dNrzk7HW8xcHeUpPra/ANsrF14TJJ4KJZT+eZcS
# icd/tPj9hbxh0glkl9ABvI4HC2FtqJJ9sqsR8O8w9Ow8PQ+QVRc+AiI621t8t6Qg
# bLebB1DsrqIIWDI5SJZukKEl/ofXrdJv6/ycAXYsC9DHdniepaAo9MiDiDAO30YI
# PiQ4sfGT5f6iIyQNp2z0OLnUK2SaEz2IKckKUDP3Fg0CAwEAAaOB6jCB5zAOBgNV
# HQ8BAf8EBAMCAQYwEgYDVR0TAQH/BAgwBgEB/wIBADAdBgNVHQ4EFgQUv5BDC6og
# yksiWkFnWLrgBCrPhcgwHwYDVR0jBBgwFoAUociMJeHbktYm26qfNaMuhoxCDGMw
# RQYIKwYBBQUHAQEEOTA3MDUGCCsGAQUFBzAChilodHRwOi8vd3d3LnNtaWxlY28u
# Y29tL2NhL3NkYy1yb290LWNhLmNlcjA6BgNVHR8EMzAxMC+gLaArhilodHRwOi8v
# d3d3LnNtaWxlY28uY29tL2NhL3NkYy1yb290LWNhLmNybDANBgkqhkiG9w0BAQsF
# AAOCAQEAvhx1ISNfpYlwnon2SDyJBIAmKCouhhqfgcn7E2U/dKFixqlRANsArtiJ
# j4DTBHuN3qkyuyFZuDyluH5jC8LMkMDpVPgmnO/cUpuqxq7It8jrw1V3hMxctOal
# yR0U/rXUC0PA2UIj9qekvFGLx81HbTix4sjnHebh/i+GwmGSdl+gi23Gw4s13UTY
# JnEEqxYkLdEfMuKX/N+irhmyfA0FQg7n+Y08U4rrLeEqWJruR/wLc4x+jruzL5HK
# Zqj3Ww433i5/fd5Fuj01YZsFqV7RL2gV3wV76117NfGMSGWJuTtVSfkWNtFZSmzj
# 5s9b6ELB30Fh7D1C7+5Xp9gODofjHzCCBZEwggR5oAMCAQICExcAA151UAhO9ML7
# DuoAAAADXnUwDQYJKoZIhvcNAQELBQAwIjEgMB4GA1UEAxMXc21pbGVjby1PV0hR
# VlNVQkNBMDEtQ0EwHhcNMjIwNjI3MTUyMDU3WhcNMjMwNjI3MTUyMDU3WjCBqjET
# MBEGCgmSJomT8ixkARkWA2NvbTEXMBUGCgmSJomT8ixkARkWB3NtaWxlY28xDDAK
# BgNVBAsTA1NEQzEPMA0GA1UECxMGR2xvYmFsMQ4wDAYDVQQLEwVVc2VyczEXMBUG
# A1UECxMOQWRtaW4gQWNjb3VudHMxETAPBgNVBAsTCEhEQWRtaW5zMR8wHQYDVQQD
# ExZBbmRyZXkgUGljYWRvIEhEIEFkbWluMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8A
# MIIBCgKCAQEAwwNYCd5eaIEbXwIK6ukcNg3r4qCAg1tSARNqdK6TEr0QwglArN+O
# wMmnbK6CgqmPCn0k+3bwJPrDxNybl59SRtlntbnZOwb2yaq2nXR0oeBQiMsJ15PC
# GvMyPp5QAWf+y2usxux5q/uVCiCXtCLLJU/C8Y+fF01yI2CUo/rU+SNqQZlM8oWC
# J0lu95ZrDYfM6ZSvP9ajd7hKdkYy1XLJM9n3t9ywGuz+QTJiue0IGlYj/4c1oZvt
# /8pegpgq0jWMMe5F/bE7wxXw6AWl4cyBU0IlHj4BPqoG18QUdtMt+/j1UrnYqH1P
# lxYKdl5AyfeUdhrdwANY5cwrWAAYQcUw2QIDAQABo4ICNTCCAjEwJQYJKwYBBAGC
# NxQCBBgeFgBDAG8AZABlAFMAaQBnAG4AaQBuAGcwEwYDVR0lBAwwCgYIKwYBBQUH
# AwMwDgYDVR0PAQH/BAQDAgeAMB0GA1UdDgQWBBQuLur7sy1aBSRzljiGkjrlU6R6
# 3TA+BgNVHREENzA1oDMGCisGAQQBgjcUAgOgJQwjQXBpY2Fkby1oZGFkbWluQHNt
# aWxlZGlyZWN0Y2x1Yi5jb20wHwYDVR0jBBgwFoAUv5BDC6ogyksiWkFnWLrgBCrP
# hcgwRgYDVR0fBD8wPTA7oDmgN4Y1aHR0cDovL3d3dy5zbWlsZWNvLmNvbS9jYS9z
# bWlsZWNvLU9XSFFWU1VCQ0EwMS1DQS5jcmwwgckGCCsGAQUFBwEBBIG8MIG5MIG2
# BggrBgEFBQcwAoaBqWxkYXA6Ly8vQ049c21pbGVjby1PV0hRVlNVQkNBMDEtQ0Es
# Q049QUlBLENOPVB1YmxpYyUyMEtleSUyMFNlcnZpY2VzLENOPVNlcnZpY2VzLENO
# PUNvbmZpZ3VyYXRpb24sREM9c21pbGVjbyxEQz1jb20/Y0FDZXJ0aWZpY2F0ZT9i
# YXNlP29iamVjdENsYXNzPWNlcnRpZmljYXRpb25BdXRob3JpdHkwTwYJKwYBBAGC
# NxkCBEIwQKA+BgorBgEEAYI3GQIBoDAELlMtMS01LTIxLTM0MjIxNjcxMjMtNjYz
# NDA0MTI2LTMzODEzMTgyOTMtNzcxMjAwDQYJKoZIhvcNAQELBQADggEBAKhJUzqz
# umy4J8Sgt/9VTrBJQcpBHVlUtYaHH9dacJnPxixVuskfG9TDSZYgHCQ3/alyf4EV
# gnXugp0MB7O4Ik1GW6c2WMdih7BKzzKhKMKJowRf7fbGqgDIW2qcz0kr1vXsmroV
# B+/GakPM+DTwTJkEBgDn2xH44eJ6LlNajxbe2/SekcqpYnkGwdlU2UR259stGhBo
# KFrZ6SbuizAZulVPTsKojvR7Q0DGTS+1ixZBumltge5AG2fFK2qxjFQq6EdHzUiA
# wtSO/0OE0wuUe9d8Woaoq26ymF8x766STmdV3cBur1LMQmJvfUqpucq7ayvyiHjb
# VEAeNb44Y2u4uc0xggHaMIIB1gIBATA5MCIxIDAeBgNVBAMTF3NtaWxlY28tT1dI
# UVZTVUJDQTAxLUNBAhMXAANedVAITvTC+w7qAAAAA151MAkGBSsOAwIaBQCgeDAY
# BgorBgEEAYI3AgEMMQowCKACgAChAoAAMBkGCSqGSIb3DQEJAzEMBgorBgEEAYI3
# AgEEMBwGCisGAQQBgjcCAQsxDjAMBgorBgEEAYI3AgEVMCMGCSqGSIb3DQEJBDEW
# BBRQJhv2mBt7BuKeuCpqHrpatgq4dDANBgkqhkiG9w0BAQEFAASCAQCzRuGm8JO1
# cPufb/8qqRNoWLVJY8vEVxSoNeDQ1QDjjFvszjqum1/a5omx5yFiMUwWSsDKGKNH
# YDzmnGfDiNwWa1N0uTur79V/9I2hu8+bhXTaYIABPOyV50202Ug/2ZGMRxL/K4nJ
# PJfTK8sq8S8DVVnjknKU7HD6wTipkqlXpiamnmJbpaE40uSGecls8nP3u6ACYIaX
# E6+5G4p4EAXa5NpEWqKHFg6iIYCmBzgF2vTM6DkxkBaRZQsECb1Qeh/etczt3ZoO
# 9578uoRSMiXrYUerG+jG3J28GfpQ3X+iloNM2nqNC13RF69zrj3HObKx1IFWhzx8
# 0giz7uooruoV
# SIG # End signature block
